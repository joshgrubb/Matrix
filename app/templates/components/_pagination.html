{#
  Reusable pagination controls.

  Expects a Flask-SQLAlchemy Pagination object in the template context.
  Works with any paginated query: users, logs, sync_logs, etc.

  The parent template should set the pagination object's variable name
  to match whichever query it paginates (e.g., users, logs, sync_logs).
  This partial auto-detects common names.
#}
{% set pagination = users if users is defined and users.pages is defined
    else logs if logs is defined and logs.pages is defined
    else sync_logs if sync_logs is defined and sync_logs.pages is defined
    else none %}

{% if pagination and pagination.pages > 1 %}
<nav aria-label="Page navigation" class="mt-3">
    <ul class="pagination justify-content-center">
        <!-- Previous page -->
        <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
            <a class="page-link"
               href="{{ request.url_root }}{{ request.path }}?{{ request.query_string.decode().replace('page=' ~ pagination.page, 'page=' ~ pagination.prev_num) if 'page=' in request.query_string.decode() else request.query_string.decode() ~ ('&' if request.query_string else '') ~ 'page=' ~ pagination.prev_num }}"
               aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        <!-- Page numbers -->
        {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if page_num %}
        <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
            <a class="page-link"
               href="?{{ request.query_string.decode().replace('page=' ~ pagination.page, 'page=' ~ page_num) if 'page=' in request.query_string.decode() else request.query_string.decode() ~ ('&' if request.query_string else '') ~ 'page=' ~ page_num }}">
                {{ page_num }}
            </a>
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">&hellip;</span></li>
        {% endif %}
        {% endfor %}

        <!-- Next page -->
        <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
            <a class="page-link"
               href="?{{ request.query_string.decode().replace('page=' ~ pagination.page, 'page=' ~ pagination.next_num) if 'page=' in request.query_string.decode() else request.query_string.decode() ~ ('&' if request.query_string else '') ~ 'page=' ~ pagination.next_num }}"
               aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</nav>
{% endif %}
